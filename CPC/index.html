<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CPC: Select Dataset</title>


    <!--======================== EXTERNAL MODULES ========================-->

    <!--    D3     -->
    <script type="text/javascript" src="./libraries/external/d3/d3.js"></script>
    <script type="text/javascript" src="./libraries/external/d3/d3-array.js"></script>

    <!--    Lodash     -->
    <script type="text/javascript" src="./libraries/external/lodash.js"></script>

    <!--    Semantic UI     -->
    <link rel="stylesheet" type="text/css" href="libraries/external/semantic/dist/semantic.min.css">
    <script src="libraries/external/jquery-3.1.1.min.js"></script>
    <script src="libraries/external/semantic/dist/semantic.min.js"></script>


    <!--     VUE     -->
    <!-- Vue development version, includes helpful console warnings -->
    <!--    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>-->

    <!-- Vue production version, optimized for size and speed -->
    <!--<script src="https://cdn.jsdelivr.net/npm/vue"></script>-->


    <!--======================== INTERNAL STYLE SHEET ======================-->
    <link rel="stylesheet" type="text/css" href="app.css">


    <!--========================== INTERNAL MODULES ========================-->
    <script type="text/javascript" src="./data/datasets.js"></script>

    <script type="text/javascript" src="libraries/utils/arrayUtils.js"></script>
    <script type="text/javascript" src="libraries/utils/classUtils.js"></script>
    <script type="text/javascript" src="libraries/utils/errorUtils.js"></script>
    <script type="text/javascript" src="libraries/utils/domUtils.js"></script>
    <script type="text/javascript" src="libraries/utils/jsUtils.js"></script>
    <script type="text/javascript" src="libraries/utils/stringUtils.js"></script>
    <script type="text/javascript" src="libraries/utils/mapUtils.js"></script>
    <script type="text/javascript" src="libraries/utils/statsUtils.js"></script>
    <script type="text/javascript" src="libraries/cpc/survey-data.js"></script>
    <script type="text/javascript" src="./libraries/cpc/data.js"></script>
    <script type="text/javascript" src="./libraries/cpc/dataset.js"></script>
    <script type="text/javascript" src="libraries/cpc/container.js"></script>
    <script type="text/javascript" src="./libraries/cpc/shape.js"></script>
    <script type="text/javascript" src="./libraries/cpc/navigator.js"></script>
    <script type="text/javascript" src="./libraries/cpc/controls.js"></script>


</head>

<body>


<!--======================== CONTROLS ========================-->


<!--========== OMIT COLUMNS TEXTBOX ==========-->

<!--        <br><br>-->
<!--        <div id='omit-columns-input' class="ui left action input">-->
<!--            <button class="ui white labeled icon button">-->
<!--                <i class="x icon"></i>-->
<!--                Omit Columns-->
<!--            </button>-->
<!--            <input v-model="vueValue" type="text" placeholder="Name,Gender..." value="">-->

<!--        &lt;!&ndash;<p>{{ vueValue.split(',') }}</p>&ndash;&gt;-->

<!--        </div>-->

<!--        <br><br>-->


<!--        <script type="text/javascript">-->

<!--            let omittedColumns = new Vue({-->

<!--                el: '#omit-columns-input',-->
<!--                data: {-->
<!--                    vueValue: 'Name'-->
<!--                }-->
<!--            })-->

<!--            let ignoredColumnsFromInput = omittedColumns.vueValue.split(',')-->

<!--        </script>-->


<div class="main-container">

    <div class="preferences-pane">


        <!--Dataset Dropdown-->
        <div class="preference-control">
            <p>Dataset:</p>
            <select class="ui dropdown"
                    id="dataset-dropdown"
                    onchange="loadSelectedDataset()">

                <option value="Titanic">Titanic</option>
                <option value="Titanic - Embark (Partial)">Titanic - Embark (Partial)</option>
                <option value="Titanic - Prediction Sample">Titanic - Prediction Sample</option>
                <option value="COVID-19">COVID-19</option>
                <option value="Wine">Wine</option>
                <option value="Big Five (2 dimensions, generated data)">Big Five (2 dimensions, generated data)</option>
                <option value="Mushrooms (4 columns)">Mushrooms (4 columns)</option>
                <option value="Mushrooms (8 columns)">Mushrooms (8 columns)</option>
            </select>

            <script>

                function parseDatasetDropdown() {
                    // Get dropdown value
                    const dropdown = document.getElementById( 'dataset-dropdown' )
                    const selectedValue = dropdown.value
                    // const selectedValue = dropdown.options[dropdown.selectedIndex]


                    // Switch dataset based on the value of the dropdown menu
                    const switchDataset = (name) => ({

                        'Titanic': {
                            path: 'http://localhost:3000/data/titanic.csv',
                            columnsToOmit: [ 'NAME' ],
                            height: 750,
                            bgTitle: 'TITANIC DATASET'

                        },

                        'Titanic - Embark (Partial)': {
                            path: 'http://localhost:3000/data/titanic-embark-partial.csv',
                            height: 750,
                            bgTitle: 'TITANIC DATASET'
                        },

                        'Titanic - Prediction Sample': {
                            path: 'http://localhost:3000/data/titanicTinyWithMockPredictions.csv',
                            columnsToOmit: ['Name', 'Ticket'],
                            columnsToForceAsCategorical: [],
                            height: 750,
                            bgTitle: 'TITANIC PREDICTIONS'
                        },

                        'COVID-19': {
                            path: 'http://localhost:3000/data/covid19/Covid19Geographic-7Countries.csv',
                            columnsToOmit: ['dateRep', 'day', 'year', 'geoId', 'countryterritoryCode', 'popData2018'],
                            columnsToForceAsCategorical: ['month'],
                            height: 750,
                            bgTitle: 'COVID-19 DATASET (APR 11)'
                        },

                        'Wine': {
                            path: 'http://localhost:3000/data/Wine/Wine-FiveColumns.csv',
                            columnsToOmit: [],
                            columnsToForceAsCategorical: [],
                            height: 750,
                            bgTitle: 'WINE DATASET'
                        },

                        'Big Five (2 dimensions, generated data)': {
                            path: 'http://localhost:3000/data/SampleMixedData.csv',
                            columnsToOmit: [],
                            columnsToForceAsCategorical: [],
                            height: 750,
                            bgTitle: 'BIG FIVE'
                        },

                        'Mushrooms (4 columns)': {
                            path: 'http://localhost:3000/data/mushrooms/mushrooms-4columns.csv',
                            columnsToOmit: [],
                            columnsToForceAsCategorical: [],
                            height: 850,
                            bgTitle: 'MUSHROOM DATASET'
                        },

                        'Mushrooms (8 columns)': {
                            path: 'http://localhost:3000/data/mushrooms/mushrooms-8columns.csv',
                            columnsToOmit: [],
                            columnsToForceAsCategorical: [],
                            height: 1400,
                            bgTitle: 'MUSHROOM DATASET'
                        }

                    })[ name ]

                    const datasetPath = switchDataset( selectedValue ).path

                    const columNamesToIgnore = !!switchDataset( selectedValue ).columnsToOmit
                        ? switchDataset( selectedValue ).columnsToOmit
                        : []

                    const columsToForceAsCategoricalData = !!switchDataset( selectedValue ).columnsToForceAsCategorical
                        ? switchDataset( selectedValue ).columnsToForceAsCategorical
                        : []

                    const height = !!switchDataset( selectedValue ).height
                        ? switchDataset( selectedValue ).height
                        : 700

                    const bgTitle = !!switchDataset( selectedValue ).bgTitle
                        ? switchDataset( selectedValue ).bgTitle
                        : 'Dataset'

                    return { datasetPath, columNamesToIgnore, columsToForceAsCategoricalData, height, bgTitle }
                }


                async function loadSelectedDataset() {

                    const { datasetPath, columNamesToIgnore, columsToForceAsCategoricalData, height, bgTitle } = parseDatasetDropdown()

                    if( !!navigator1 )
                        navigator1.remove()

                    navigator1 = new navigator.Navigator()

                    navigator1.loadDataset(
                        datasetPath,
                        columNamesToIgnore,
                        columsToForceAsCategoricalData
                    ).then( that => {

                        that.colorSet( 'Titanic-2' )
                            .x(300)
                            .height(height)
                            .build()


                        that.objects('panel-0-0').bgText( bgTitle ).update()

                        allNavigators[0] = that

                    } )


                }

            </script>

        </div>


        <!-- Panel Width Slider -->
        <div id="panel-width-control" class="preference-control">

            <p>Panel width: <span id="panel-width-text">100px</span></p>

            <input type="range"
                   class="slider"
                   id=panel-width-slider
                   value=100
                   step=10
                   min=100
                   max=400
                   onchange="setPanelWidth()"
            >

            <script>

                // PANEL WIDTH SLIDER //
                function setPanelWidth() {

                    // Get slider value and text
                    const slider = document.getElementById( 'panel-width-slider' )
                    const text = document.getElementById( 'panel-width-text' )

                    // Update displayed text
                    text.innerText = Number( slider.value )

                    // Change the value
                    allNavigators.forEach( (navigatorObject) => {

                        navigatorObject
                            .width( Number( slider.value ) )
                            .update()

                    } )

                }
            </script>


        </div>

        <!--Category Connectors checkbox-->
        <div class="preference-control ui checkbox">
            <input type="checkbox" name="example" id="category-connectors-checkbox" onclick="toggleConnectorPolygons()">
            <label>Category connectors</label>


            <script>

                function toggleConnectorPolygons() {

                    // Get the checkbox element
                    const checkBox1 = document.getElementById( 'category-connectors-checkbox' )

                    // Toggle labels based on checkbox status
                    allNavigators.forEach( (navigator) => {

                        if( checkBox1.checked === true ) {
                            navigator.showConnectorPolygons( true )
                        }
                        else {
                            navigator.showConnectorPolygons( false )
                        }

                        navigator.update()
                    } )

                }
            </script>

        </div>


        <!--Absolute Values Checkbox-->
        <div class="preference-control ui checkbox">
            <input type="checkbox" name="example" id="checkbox1" onclick="toggleAbsoluteValues()">
            <label>Absolute values</label>


            <script>

                function toggleAbsoluteValues() {

                    // Get the checkbox element
                    const checkBox1 = document.getElementById( 'checkbox1' )

                    // Toggle labels based on checkbox status
                    allNavigators.forEach( (navigator) => {

                        if( checkBox1.checked === true ) {
                            navigator.showAbsoluteValues( true )
                        }
                        else {
                            navigator.showAbsoluteValues( false )
                        }

                        navigator.update()
                    } )

                }
            </script>

        </div>


        <!--Absolute Chart Widths Checkbox-->
        <div class="preference-control ui checkbox">
            <input type="checkbox" name="example" id="absolute-chart-widths-checkbox"
                   onclick="toggleAbsoluteChartWidths()">
            <label>Absolute chart widths</label>


            <script>

                function toggleAbsoluteChartWidths() {

                    // Get the checkbox element
                    const checkBox1 = document.getElementById( 'absolute-chart-widths-checkbox' )

                    // Toggle labels based on checkbox status
                    allNavigators.forEach( navigator => {

                        if( checkBox1.checked === true ) {
                            navigator.showAbsoluteChartWidths( true )
                        }
                        else {
                            navigator.showAbsoluteChartWidths( false )
                        }

                        navigator.update()
                    } )

                }
            </script>

        </div>


        <!--            &lt;!&ndash;Show Category Texts Checkbox&ndash;&gt;-->
        <!--            <div class="preference-control ui checkbox">-->
        <!--                <input type="checkbox" name="example" id="show-category-texts-checkbox" onclick="toggleCategoryTexts()">-->
        <!--                <label>Hide category texts</label>-->


        <!--                <script>-->

        <!--                    function toggleCategoryTexts() {-->

        <!--                        // Get the checkbox element-->
        <!--                        const checkBox1 = document.getElementById("show-category-texts-checkbox")-->

        <!--                        allNavigators.forEach( navigator => {-->

        <!--                            if (checkBox1.checked === true ){-->
        <!--                                navigator.showCategoryCaptions = true-->
        <!--                            } else {-->
        <!--                                navigator.showCategoryCaptions = false-->
        <!--                            }-->

        <!--                            navigator.update()-->
        <!--                        })-->


        <!--                    }-->
        <!--                </script>-->

        <!--            </div>-->


        <!--Color Scheme Dropdown-->
        <div class="preference-control">
            <!--<p>ColorScheme</p>-->
            <select class="ui dropdown"
                    id="navigator-1-color-scheme-dropdown"
                    onchange="setColorScheme()">

                <option value="">ColorScheme</option>
                <option value=Single-Hue>Single-Hue</option>
                <option value=Multi-Hue>Multi-Hue</option>
                <option value=Titanic>Titanic</option>
                <option value=Titanic-2>Titanic-2</option>
                <option value='Blues'>Blues</option>
                <option value='Greens'>Greens</option>
                <option value='Greys'>Greys</option>
                <option value='Oranges'>Oranges</option>
                <option value='Purples'>Purples</option>
                <option value='Reds'>Reds</option>
                <option value='BuGn'>BuGn</option>
                <option value='BuPu'>BuPu</option>
                <option value='GnBu'>GnBu</option>
                <option value='OrRd'>OrRd</option>
                <option value='PuBuGn'>PuBuGn</option>
                <option value='PuBu'>PuBu</option>
                <option value='PuRd'>PuRd</option>
                <option value='RdPu'>RdPu</option>
                <option value='YlGnBu'>YlGnBu</option>
                <option value='YlGn'>YlGn</option>
                <option value='YlOrBr'>YlOrBr</option>
                <option value='YlOrRd'>YlOrRd</option>
                <option value='Viridis'>Viridis</option>
                <option value='Inferno'>Inferno</option>
                <option value='Magma'>Magma</option>
                <option value='Warm'>Warm</option>
                <option value='Cool'>Cool</option>
                <option value='CubehelixDefault'>CubehelixDefault</option>
                <option value='Plasma'>Plasma</option>
            </select>

            <script>

                function setColorScheme() {

                    // Get dropdown value
                    const dropdown = document.getElementById( 'navigator-1-color-scheme-dropdown' )
                    const selectedValue = dropdown.value
                    // const selectedValue = dropdown.options[dropdown.selectedIndex]

                    allNavigators.forEach( (navigator) => {
                        navigator
                            .colorSet( selectedValue )
                            .update()
                    } )

                }

            </script>

        </div>


        <!--Animation Duration Slider-->
        <div class="preference-control">

            <p>Animation duration: <span id="animation-duration-text">600</span></p>

            <input type="range"
                   class="slider"
                   id=animation-duration-slider
                   value=600
                   max=2500
                   min=100
                   onchange="setAnimationDuration()"
            >


            <script>

                function setAnimationDuration() {

                    // Get slider value and text
                    const animationDurationSlider = document.getElementById( 'animation-duration-slider' )
                    const animationDurationText = document.getElementById( 'animation-duration-text' )

                    // Update animation duration text
                    animationDurationText.innerText = Number( animationDurationSlider.value )

                    // Change animation duration
                    allNavigators.forEach( (navigator) => {

                        navigator
                            .animationDuration( Number( animationDurationSlider.value ) )
                            .update()
                    } )

                }

            </script>

        </div>


        <!-- Stroke Width Slider-->
        <div id="stroke-width-control" class="preference-control">

            <p>Stroke width: <span id="stroke-width-text">0.5</span>px</p>

            <input type="range"
                   class="slider"
                   id=stroke-width-slider
                   value=0.5
                   step=0.5
                   max=6
                   min=0
                   onchange="setStrokeWidth()"
            >

            <script>

                // STROKE WIDTH SLIDER //
                function setStrokeWidth() {

                    // Get slider value and text
                    const slider = document.getElementById( 'stroke-width-slider' )
                    const text = document.getElementById( 'stroke-width-text' )

                    // Update displayed text
                    text.innerText = Number( slider.value )

                    // Change the value
                    allNavigators.forEach( (navigatorObject, navigatorName) => {

                        navigatorObject
                            .strokeWidth( `${Number( slider.value )}px` )
                            .update()

                    } )

                }
            </script>


        </div>

        <!-- Stroke Color Dropdown-->
        <div id="stroke-color-control" class="preference-control">

            <!--<p>ColorScheme</p>-->
            <select class="ui dropdown"
                    id="stroke-color-dropdown"
                    onchange="setStrokeColor()"
            >

                <option value="white">White</option>
                <option value="black">Black</option>

            </select>

            <script>
                function setStrokeColor() {

                    // Get dropdown value
                    const dropdown = document.getElementById( 'stroke-color-dropdown' )
                    const selectedValue = dropdown.value
                    // const selectedValue = dropdown.options[dropdown.selectedIndex]

                    // Change the value
                    allNavigators.forEach( (navigatorObject, navigatorName) => {

                        navigatorObject
                            .stroke( `${selectedValue}` )
                            .update()

                    } )

                }
            </script>

        </div>


    </div>

    <div class="navigator-area"></div>

</div>


<!--======================== NAVIGATOR LOGIC ========================-->

<script>

    //// SVG  ////

    const parentD3Element = d3.select( '.navigator-area' )

    let mySvg = new container.Svg(15000, 15000, parentD3Element)


    const { datasetPath, columNamesToIgnore, columsToForceAsCategoricalData, height } = parseDatasetDropdown()

    let navigator1 = new navigator.Navigator()

    navigator1.loadDataset(
        datasetPath,
        columNamesToIgnore,
        columsToForceAsCategoricalData
    ).then( that => {

        that.colorSet( 'Titanic-2' )
            .height(height)
            .x(300)
            .build()

    } )


    const allNavigators = [
        navigator1
    ]




</script>

<!--==================== GENERAL INTERFACE LOGIC =====================-->



</body>
</html>
