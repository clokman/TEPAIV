<!DOCTYPE html>
<html lang="en">
    <head>

        <meta charset="UTF-8">
        <title>Scales</title>

        <script type="text/javascript" src="d3.js"></script>

        <style>

        </style>

    </head>

    <body>

        <p>Click to update (once).</p>

        <script type="text/javascript">

            // DATA ////////////////////////////////////////////////

            var dataset = [ 5, 10, 13, 19, 21, 25, 22, 18, 15, 13,
                11, 12, 15, 20, 18, 17, 16, 18, 23, 25 ];



            // PARAMS ////////////////////////////////////////////////

            var canvasHeight = 250;
            var canvasWidth =  600;


            // SCALES ////////////////////////////////////////////////

            var xScale = d3.scaleBand()
                .domain(d3.range(dataset.length))  // creates [1, 2, 3, 4 ... 24, 25]
                .rangeRound([0, canvasWidth])
                .paddingInner(0.05);


            var yScale = d3.scaleLinear()
                .domain([0, d3.max(dataset)])
                .rangeRound([0, canvasHeight]);



            // CANVAS  //////////////////////////////////////////////

            var svg = d3.select('body')
                .append('svg')
                .attr('width', canvasWidth)
                .attr('height', canvasHeight);



            // BARS  //////////////////////////////////////////////

            var bars = svg
                .selectAll('rect')
                .data(dataset)
                .enter()
                .append('rect')
                .attr('x', function (d, i) {
                    return xScale(i)  // return the position of each element in the xScale
                })
                .attr('y', function(d){
                    return canvasHeight-yScale(d)
                })
                .attr('width', xScale.bandwidth())  // return the bar width
                .attr('height', function (d) {
                    return yScale(d)
                })
                .attr('fill', function (d) {
                    return 'rgb(0,0,' + Math.round(d*10) + ')'
                });


            // LABELS //////////////////////////////////////////////

            var labels = svg
                .selectAll('text')
                .data(dataset)
                .enter()
                .append('text')
                .text(function (d) {
                    return d
                })
                .attr('x', function (d, i) {
                    return xScale(i) + xScale.bandwidth() / 2
                })
                .attr('y', function (d) {
                    return canvasHeight - yScale(d) + 14
                })
                .attr('font-family', 'sans-serif')
                .attr('font-size', '11px')
                .attr('fill', 'white')
                .attr('text-anchor', 'middle');


            // UPDATE ON CLICK //////////////////////////////////////

            d3.select('p')
                .on('click', function () {

                    // New values for dataset
                    dataset = [ 11, 12, 15, 20, 18, 17, 16, 18, 23, 25,
                        5, 10, 13, 19, 21, 25, 22, 18, 15, 13 ];

                    // Update all rects
                    svg.selectAll('rect')
                        .data(dataset)
                        .attr('y', function (d) {
                            return canvasHeight - yScale(d)
                        })
                        .attr('height', function (d) {
                            return yScale(d)
                        })
                        .attr('fill', function (d) {    // update bar colors
                            return 'rgb(0,0,' + Math.round(d*10) + ')'
                        });


                    // Update labels
                    svg.selectAll('text')
                        .data(dataset)        // bind with new values
                        .text(function (d) {  // update label content
                            return d
                        })
                        .attr('x', function (d, i) {
                            return xScale(i) + xScale.bandwidth() / 2
                        })
                        .attr('y', function (d) {
                            return canvasHeight - yScale(d) + 14
                        })

                });
            // AXES //////////////////////////////////////////////

            // Create X axis

            // Add X axis


            // Create Y axis

            // Add Y axis


        </script>

    </body>

</html>