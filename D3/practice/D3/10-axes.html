<!DOCTYPE html>
<html lang="en">
    <head>

        <meta charset="UTF-8">
        <title>Scales</title>

        <script type="text/javascript" src="d3.js"></script>

        <style>
            .axis path, .axis line {
                stroke: lightslategray;
                shape-rendering: crispEdges;
            }

            .axis text{
                font-family: Optima, Futura, sans-serif;
                font-weight: lighter;
                font-size: 12px;
                fill: lightslategray;
            }

        </style>

    </head>

    <body>

        <script type="text/javascript">

            // PARAMS ////////////////////////////////////////////////

            var canvasWidth = 500;
            var canvasHeight = 400;

            var padding = 25;



            // Dynamic, random dataset
            var dataset = [];
            var numDataPoints = 50;
            var xRange = Math.random() * 1000;
            var yRange = Math.random() * 1000;
            for (var i = 0; i < numDataPoints; i++) {
                var newNumber1 = Math.floor(Math.random() * xRange);
                var newNumber2 = Math.floor(Math.random() * yRange);
                dataset.push([newNumber1, newNumber2]);
            }


            // var dataset = [
            //     [5,     20],
            //     [480,   90],
            //     [250,   50],
            //     [100,   33],
            //     [330,   95],
            //     [410,   12],
            //     [475,   44],
            //     [25,    67],
            //     [85,    21],
            //     [220,   88],
            //     [600,   150]
            // ];



            // SCALES ////////////////////////////////////////////////

            // var scale = d3.scaleLinear()
            //               .domain([100, 500])
            //               .range([0,350])


            // Dynamic scale for x axis
            var xMax = d3.max(dataset, function (d) {
                return d[0]
            });

            var xMin = d3.min(dataset, function (d) {
                return d[0]
            });

            var xScale = d3.scaleLinear()
                .domain([0, xMax])
                .range([padding * 3, canvasWidth - padding]);



            // Dynamic scale for y axis
            var yMax = d3.max(dataset, function (d) {
                return d[1]
            });

            var yMin = d3.min(dataset, function (d) {
                return d[1]
            });

            var yScale = d3.scaleLinear()
                .domain([yMax, 0])  // y axis need is inverted due to SVG coordinate system
                .range([padding, canvasHeight-padding]);  // range is not inverted (cross-mapping from domain to range)



            // Scale for circle radii

            // var radiusScale = d3.scaleLinear()
            //     .domain([yMin, yMax])
            //     .range([2, 5]);

            // circle size reflects the size of the values on the 'y' axis
            var radiusScale = d3.scaleSqrt()
                .domain([0, d3.max(dataset, function (d) { return d[1]; })])
                .range([0, 10]);



            // SCATTERPLOT //////////////////////////////////////////////

            // SVG canvas
            var svg = d3.select('body')
                .append('svg')
                .attr('width', canvasWidth)
                .attr('height', canvasHeight);

            // Circles
            svg.selectAll('circle')
                .data(dataset)
                .enter()
                .append('circle')
                .attr('cx', function (d) {
                    return xScale(d[0]);
                })
                .attr('cy', function (d) {
                    return yScale(d[1]);
                })
                .attr('r', function (d) {
                    return  radiusScale(d[1]);
                });



            // Labels
            // svg.selectAll('text')
            //     .data(dataset)
            //     .enter()
            //     .append('text')
            //     .text(function (d) {
            //         return d[0] + ',' + d[1];
            //     })
            //     .attr('x', function (d) {
            //         return xScale(d[0]);
            //     })
            //     .attr('y', function (d) {
            //         return yScale(d[1]);
            //     })
            //     .attr('fill', 'red');


            // AXES //////////////////////////////////////////////

            // Create X axis
            var xAxis = d3.axisBottom()
                          .scale(xScale)
                          .ticks(5);

            // Add X axis
            svg.append('g')             // g is an abbreviation for 'group' in SVG.
                .attr('class', 'axis')  // name the group as 'axis'
                .attr('transform', 'translate(0, ' +  (canvasHeight - padding) + ')')
                .call(xAxis);            // call() is used to add elements to the group


            // Create Y axis
            var yAxis = d3.axisLeft()
                .scale(yScale)
                .ticks(5);

            // Add Y axis
            svg.append('g')             // g is an abbreviation for 'group' in SVG.
                .attr('class', 'axis')  // name the group as 'axis'
                .attr('transform', 'translate(' + padding * 2.9 + ', 0)')
                .call(yAxis);            // call() is used to add elements to the group


        </script>

    </body>

</html>